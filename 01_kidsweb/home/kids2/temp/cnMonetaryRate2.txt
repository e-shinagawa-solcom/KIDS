  SELECT dtmApplyEndDate,  CASE   WHEN lngMonetaryRateCode = 1 or lngMonetaryUnitCode = 3    THEN to_char ( date_trunc('month', dtmApplyEndDate + interval '2 month' ) - interval '1 day', 'YYYY/MM/DD')    ELSE to_char ( date_trunc('month', dtmApplyEndDate + interval '1 year' + interval '1 month' ) - interval '1 day', 'YYYY/MM/DD')  END FROM m_MonetaryRate WHERE lngMonetaryRateCode = 2 AND lngMonetaryUnitCode = 3 AND dtmApplyStartDate < now() AND dtmApplyEndDate > now() UNION SELECT now() AS dtmApplyEndDate, CASE   WHEN 1 = 2 or 3= 3    THEN to_char ( date_trunc('month', now() + interval '1 month' ) - interval '1 day', 'YYYY/MM/DD')    ELSE to_char ( date_trunc('month', now() + interval '1 year' + interval '1 month' ) - interval '1 day', 'YYYY/MM/DD')  END ORDER BY dtmApplyEndDate DESC 
  SELECT dtmApplyEndDate,  CASE   WHEN lngMonetaryRateCode = 1 or lngMonetaryUnitCode = 3    THEN to_char ( date_trunc('month', dtmApplyEndDate + interval '2 month' ) - interval '1 day', 'YYYY/MM/DD')    ELSE to_char ( date_trunc('month', dtmApplyEndDate + interval '1 year' + interval '1 month' ) - interval '1 day', 'YYYY/MM/DD')  END FROM m_MonetaryRate WHERE lngMonetaryRateCode = 2 AND lngMonetaryUnitCode = 3 AND dtmApplyStartDate < now() AND dtmApplyEndDate > now() UNION SELECT now() AS dtmApplyEndDate, CASE   WHEN 1 = 2 or 3= 3    THEN to_char ( date_trunc('month', now() + interval '1 month' ) - interval '1 day', 'YYYY/MM/DD')    ELSE to_char ( date_trunc('month', now() + interval '1 year' + interval '1 month' ) - interval '1 day', 'YYYY/MM/DD')  END ORDER BY dtmApplyEndDate DESC 
id	name1
2019-01-07 09:55:04.795175+09	2019/01/31
