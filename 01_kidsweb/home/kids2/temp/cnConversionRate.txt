 SELECT mmr.lngMonetaryRateCode, mmr.curConversionRate, MAX(mmr.dtmapplystartdate) FROM m_MonetaryRate mmr JOIN m_monetaryunit mmu on mmr.lngmonetaryunitcode = mmu.lngmonetaryunitcode WHERE mmr.lngmonetaryratecode = '2' AND mmu.strmonetaryunitsign = 'US$' AND mmr.dtmapplystartdate = (SELECT MAX(mmr2.dtmapplystartdate) FROM m_MonetaryRate mmr2 WHERE mmr2.lngMonetaryRateCode = mmr.lngMonetaryRateCode AND mmr2.lngMonetaryUnitCode = mmr.lngMonetaryUnitCode) GROUP BY mmr.lngMonetaryRateCode, mmr.curConversionRate UNION SELECT mmr.lngMonetaryRateCode, mmr.curConversionRate, MAX(mmr.dtmapplystartdate) FROM m_MonetaryRate mmr JOIN m_monetaryunit mmu on mmr.lngmonetaryunitcode = mmu.lngmonetaryunitcode WHERE mmr.dtmapplystartdate <= '2019/01/22' AND mmr.dtmapplyenddate >= '2019/01/22' AND mmr.lngmonetaryratecode = '2' AND mmu.strmonetaryunitsign = 'US$' GROUP BY mmr.lngMonetaryRateCode, mmr.curConversionRate ORDER BY 3 
 SELECT mmr.lngMonetaryRateCode, mmr.curConversionRate, MAX(mmr.dtmapplystartdate) FROM m_MonetaryRate mmr JOIN m_monetaryunit mmu on mmr.lngmonetaryunitcode = mmu.lngmonetaryunitcode WHERE mmr.lngmonetaryratecode = '2' AND mmu.strmonetaryunitsign = 'US$' AND mmr.dtmapplystartdate = (SELECT MAX(mmr2.dtmapplystartdate) FROM m_MonetaryRate mmr2 WHERE mmr2.lngMonetaryRateCode = mmr.lngMonetaryRateCode AND mmr2.lngMonetaryUnitCode = mmr.lngMonetaryUnitCode) GROUP BY mmr.lngMonetaryRateCode, mmr.curConversionRate UNION SELECT mmr.lngMonetaryRateCode, mmr.curConversionRate, MAX(mmr.dtmapplystartdate) FROM m_MonetaryRate mmr JOIN m_monetaryunit mmu on mmr.lngmonetaryunitcode = mmu.lngmonetaryunitcode WHERE mmr.dtmapplystartdate <= '2019/01/22' AND mmr.dtmapplyenddate >= '2019/01/22' AND mmr.lngmonetaryratecode = '2' AND mmu.strmonetaryunitsign = 'US$' GROUP BY mmr.lngMonetaryRateCode, mmr.curConversionRate ORDER BY 3 
id	name1	name2
2	110.000000	2018-04-01
